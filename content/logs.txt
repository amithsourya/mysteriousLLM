
Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://34.125.207.96:8501

2025-05-17 06:35:41.353202: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1747463741.585801   16115 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1747463741.650848   16115 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:16<00:16, 16.15s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:18<00:00,  8.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:18<00:00,  9.25s/it]
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m409[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m406 [0m[2;33m│   [0m[33m</Tip>[0m                                                                     [31m [0m
[31m [0m   [2m407 [0m[2;33m│   [0m[33m"""[0m                                                                        [31m [0m
[31m [0m   [2m408 [0m[2m│   [0m[94mtry[0m:                                                                       [31m [0m
[31m [0m [31m❱ [0m409 [2m│   │   [0mresponse.raise_for_status()                                            [31m [0m
[31m [0m   [2m410 [0m[2m│   [0m[94mexcept[0m HTTPError [94mas[0m e:                                                     [31m [0m
[31m [0m   [2m411 [0m[2m│   │   [0merror_code = response.headers.get([33m"[0m[33mX-Error-Code[0m[33m"[0m)                      [31m [0m
[31m [0m   [2m412 [0m[2m│   │   [0merror_message = response.headers.get([33m"[0m[33mX-Error-Message[0m[33m"[0m)                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/requests/[0m[1;33mmodels.py[0m:[94m1024[0m in [92mraise_for_status[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1021 [0m[2m│   │   │   [0m)                                                                 [31m [0m
[31m [0m   [2m1022 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1023 [0m[2m│   │   [0m[94mif[0m http_error_msg:                                                    [31m [0m
[31m [0m [31m❱ [0m1024 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m HTTPError(http_error_msg, response=[0m[1;4;96mself[0m[1;4m)[0m                    [31m [0m
[31m [0m   [2m1025 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1026 [0m[2m│   [0m[94mdef[0m[90m [0m[92mclose[0m([96mself[0m):                                                          [31m [0m
[31m [0m   [2m1027 [0m[2;90m│   │   [0m[33m"""Releases the connection back to the pool. Once this method has bee[0m [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mHTTPError: [0m[1;36m401[0m Client Error: Unauthorized for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json[0m

[3mThe above exception was the direct cause of the following exception:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m260[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m257 [0m[2m│   │   │   [0mconfig_file = os.path.join(path, CONFIG_NAME)                      [31m [0m
[31m [0m   [2m258 [0m[2m│   │   [0m[94melse[0m:                                                                  [31m [0m
[31m [0m   [2m259 [0m[2m│   │   │   [0m[94mtry[0m:                                                               [31m [0m
[31m [0m [31m❱ [0m260 [2m│   │   │   │   [0mconfig_file = hf_hub_download(                                 [31m [0m
[31m [0m   [2m261 [0m[2m│   │   │   │   │   [0mmodel_id,                                                  [31m [0m
[31m [0m   [2m262 [0m[2m│   │   │   │   │   [0mCONFIG_NAME,                                               [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1008[0m in     [31m [0m
[31m [0m [92mhf_hub_download[0m                                                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1005 [0m[2m│   │   │   [0mlocal_files_only=local_files_only,                                [31m [0m
[31m [0m   [2m1006 [0m[2m│   │   [0m)                                                                     [31m [0m
[31m [0m   [2m1007 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m [31m❱ [0m1008 [2m│   │   [0m[94mreturn[0m _hf_hub_download_to_cache_dir(                                 [31m [0m
[31m [0m   [2m1009 [0m[2m│   │   │   [0m[2m# Destination[0m                                                     [31m [0m
[31m [0m   [2m1010 [0m[2m│   │   │   [0mcache_dir=cache_dir,                                              [31m [0m
[31m [0m   [2m1011 [0m[2m│   │   │   [0m[2m# File info[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1115[0m in     [31m [0m
[31m [0m [92m_hf_hub_download_to_cache_dir[0m                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1112 [0m[2m│   │   │   │   │   [0m[94mreturn[0m pointer_path                                       [31m [0m
[31m [0m   [2m1113 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1114 [0m[2m│   │   [0m[2m# Otherwise, raise appropriate error[0m                                  [31m [0m
[31m [0m [31m❱ [0m1115 [2m│   │   [0m[1;4m_raise_on_head_call_error(head_call_error, force_download, local_file[0m [31m [0m
[31m [0m   [2m1116 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1117 [0m[2m│   [0m[2m# From now on, etag, commit_hash, url and size are not None.[0m              [31m [0m
[31m [0m   [2m1118 [0m[2m│   [0m[94massert[0m etag [95mis[0m [95mnot[0m [94mNone[0m, [33m"[0m[33metag must have been retrieved from server[0m[33m"[0m      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1643[0m in     [31m [0m
[31m [0m [92m_raise_on_head_call_error[0m                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1640 [0m[2m│   [0m):                                                                        [31m [0m
[31m [0m   [2m1641 [0m[2m│   │   [0m[2m# Repo not found or gated => let's raise the actual error[0m             [31m [0m
[31m [0m   [2m1642 [0m[2m│   │   [0m[2m# Unauthorized => likely a token issue => let's raise the actual erro[0m [31m [0m
[31m [0m [31m❱ [0m1643 [2m│   │   [0m[1;4;94mraise[0m[1;4m head_call_error[0m                                                 [31m [0m
[31m [0m   [2m1644 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m   [2m1645 [0m[2m│   │   [0m[2m# Otherwise: most likely a connection issue or Hub downtime => let's [0m [31m [0m
[31m [0m   [2m1646 [0m[2m│   │   [0m[94mraise[0m LocalEntryNotFoundError(                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1531[0m in     [31m [0m
[31m [0m [92m_get_metadata_or_catch_error[0m                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1528 [0m[2m│   [0m[94mif[0m [95mnot[0m local_files_only:                                                  [31m [0m
[31m [0m   [2m1529 [0m[2m│   │   [0m[94mtry[0m:                                                                  [31m [0m
[31m [0m   [2m1530 [0m[2m│   │   │   [0m[94mtry[0m:                                                              [31m [0m
[31m [0m [31m❱ [0m1531 [2m│   │   │   │   [0mmetadata = get_hf_file_metadata(                              [31m [0m
[31m [0m   [2m1532 [0m[2m│   │   │   │   │   [0murl=url, proxies=proxies, timeout=etag_timeout, headers=h [31m [0m
[31m [0m   [2m1533 [0m[2m│   │   │   │   [0m)                                                             [31m [0m
[31m [0m   [2m1534 [0m[2m│   │   │   [0m[94mexcept[0m EntryNotFoundError [94mas[0m http_error:                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1448[0m in     [31m [0m
[31m [0m [92mget_hf_file_metadata[0m                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1445 [0m[2m│   [0mhf_headers[[33m"[0m[33mAccept-Encoding[0m[33m"[0m] = [33m"[0m[33midentity[0m[33m"[0m  [2m# prevent any compression => [0m [31m [0m
[31m [0m   [2m1446 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1447 [0m[2m│   [0m[2m# Retrieve metadata[0m                                                       [31m [0m
[31m [0m [31m❱ [0m1448 [2m│   [0mr = _request_wrapper(                                                     [31m [0m
[31m [0m   [2m1449 [0m[2m│   │   [0mmethod=[33m"[0m[33mHEAD[0m[33m"[0m,                                                        [31m [0m
[31m [0m   [2m1450 [0m[2m│   │   [0murl=url,                                                              [31m [0m
[31m [0m   [2m1451 [0m[2m│   │   [0mheaders=hf_headers,                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m286[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 283 [0m[2;33m│   [0m[33m"""[0m                                                                       [31m [0m
[31m [0m   [2m 284 [0m[2m│   [0m[2m# Recursively follow relative redirects[0m                                   [31m [0m
[31m [0m   [2m 285 [0m[2m│   [0m[94mif[0m follow_relative_redirects:                                             [31m [0m
[31m [0m [31m❱ [0m 286 [2m│   │   [0mresponse = _request_wrapper(                                          [31m [0m
[31m [0m   [2m 287 [0m[2m│   │   │   [0mmethod=method,                                                    [31m [0m
[31m [0m   [2m 288 [0m[2m│   │   │   [0murl=url,                                                          [31m [0m
[31m [0m   [2m 289 [0m[2m│   │   │   [0mfollow_relative_redirects=[94mFalse[0m,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m310[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 307 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 308 [0m[2m│   [0m[2m# Perform request and return if status_code is not in the retry list.[0m     [31m [0m
[31m [0m   [2m 309 [0m[2m│   [0mresponse = http_backoff(method=method, url=url, **params, retry_on_except [31m [0m
[31m [0m [31m❱ [0m 310 [2m│   [0m[1;4mhf_raise_for_status(response)[0m                                             [31m [0m
[31m [0m   [2m 311 [0m[2m│   [0m[94mreturn[0m response                                                           [31m [0m
[31m [0m   [2m 312 [0m                                                                              [31m [0m
[31m [0m   [2m 313 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m459[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m456 [0m[2m│   │   │   │   [0m[33m"[0m[33m make sure you are authenticated. For more details, see[0m[33m"[0m      [31m [0m
[31m [0m   [2m457 [0m[2m│   │   │   │   [0m[33m"[0m[33m https://huggingface.co/docs/huggingface_hub/authentication[0m[33m"[0m  [31m [0m
[31m [0m   [2m458 [0m[2m│   │   │   [0m)                                                                  [31m [0m
[31m [0m [31m❱ [0m459 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m _format(RepositoryNotFoundError, message, response) [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96me[0m   [31m [0m
[31m [0m   [2m460 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m461 [0m[2m│   │   [0m[94melif[0m response.status_code == [94m400[0m:                                      [31m [0m
[31m [0m   [2m462 [0m[2m│   │   │   [0mmessage = (                                                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mRepositoryNotFoundError: [0m[1;36m401[0m Client Error. [1m([0mRequest ID: 
[33mRoot[0m=[1;36m1[0m-[1;36m68282e57[0m-32868b3054ccf47147c282a3;[93mf943c86a-78e7-49a2-a1b9-b8033a7ad10f[0m[1m)[0m

Repository Not Found for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json.[0m
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated. 
For more details, see [4;94mhttps://huggingface.co/docs/huggingface_hub/authentication[0m
Invalid username or password.

[3mDuring handling of the above exception, another exception occurred:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m121[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m645[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m39[0m in [92m<module>[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m   [2m 37 [0m                                                                               [31m [0m
[31m [0m   [2m 38 [0m[94mwith[0m st.spinner([33m"[0m[33mLoading model and tokenizer...[0m[33m"[0m):                             [31m [0m
[31m [0m [31m❱ [0m 39 [2m│   [0mmodel, tokenizer = [1;4mload_model(use_entity_personality)[0m                      [31m [0m
[31m [0m   [2m 40 [0m[2m│   [0mpipe = pipeline([33m"[0m[33mtext-generation[0m[33m"[0m, model=model, tokenizer=tokenizer, devic [31m [0m
[31m [0m   [2m 41 [0m                                                                               [31m [0m
[31m [0m   [2m 42 [0m[2m# --- Lore setup ---[0m                                                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m33[0m in [92mload_model[0m                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 30 [0m[2m│   [0m)                                                                          [31m [0m
[31m [0m   [2m 31 [0m[2m│   [0mtokenizer = AutoTokenizer.from_pretrained([33m"[0m[33mmicrosoft/phi-2[0m[33m"[0m)               [31m [0m
[31m [0m   [2m 32 [0m[2m│   [0m[94mif[0m use_entity:                                                             [31m [0m
[31m [0m [31m❱ [0m 33 [2m│   │   [0mmodel = [1;4mPeftModel.from_pretrained(base_model, [0m[1;4;33m"[0m[1;4;33madapters/entity_lora_ad[0m [31m [0m
[31m [0m   [2m 34 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m   [2m 35 [0m[2m│   │   [0mmodel = base_model                                                     [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mpeft_model.py[0m:[94m439[0m in [92mfrom_pretrained[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 436 [0m[2m│   │   [0m[2m# load the config[0m                                                     [31m [0m
[31m [0m   [2m 437 [0m[2m│   │   [0m[94mif[0m config [95mis[0m [94mNone[0m:                                                    [31m [0m
[31m [0m   [2m 438 [0m[2m│   │   │   [0mconfig = PEFT_TYPE_TO_CONFIG_MAPPING[                             [31m [0m
[31m [0m [31m❱ [0m 439 [2m│   │   │   │   [0mPeftConfig._get_peft_type(                                    [31m [0m
[31m [0m   [2m 440 [0m[2m│   │   │   │   │   [0mmodel_id,                                                 [31m [0m
[31m [0m   [2m 441 [0m[2m│   │   │   │   │   [0msubfolder=kwargs.get([33m"[0m[33msubfolder[0m[33m"[0m, [94mNone[0m),                  [31m [0m
[31m [0m   [2m 442 [0m[2m│   │   │   │   │   [0mrevision=kwargs.get([33m"[0m[33mrevision[0m[33m"[0m, [94mNone[0m),                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m266[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m   [2m264 [0m[2m│   │   │   │   [0m)                                                              [31m [0m
[31m [0m   [2m265 [0m[2m│   │   │   [0m[94mexcept[0m [96mException[0m:                                                  [31m [0m
[31m [0m [31m❱ [0m266 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mValueError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33mCan[0m[1;4;33m'[0m[1;4;33mt find [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mCONFIG_NAME[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m at [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mmodel_id[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m"[0m [31m [0m
[31m [0m   [2m267 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m268 [0m[2m│   │   [0mloaded_attributes = [96mcls[0m.from_json_file(config_file)                    [31m [0m
[31m [0m   [2m269 [0m[2m│   │   [0m[94mreturn[0m loaded_attributes[[33m"[0m[33mpeft_type[0m[33m"[0m]                                  [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mValueError: [0mCan't find [32m'adapter_config.json'[0m at [32m'adapters/entity_lora_adapter'[0m
2025-05-17 06:36:09.023 Examining the path of torch.classes raised:
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/local_sources_watcher.py", line 217, in get_module_paths
    potential_paths = extract_paths(module)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/local_sources_watcher.py", line 210, in <lambda>
    lambda m: list(m.__path__._path),
                   ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/_classes.py", line 13, in __getattr__
    proxy = torch._C._get_custom_class_python_wrapper(self.name, attr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Tried to instantiate class '__path__._path', but it does not exist! Ensure that it is registered via torch::class_
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:22<00:22, 22.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:25<00:00, 11.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:25<00:00, 12.80s/it]
Device set to use cuda:0
Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
WARNING:huggingface_hub.file_download:Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m121[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m645[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m58[0m in [92m<module>[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 55 [0m[2m│   [0mindex.add(embeddings)                                                      [31m [0m
[31m [0m   [2m 56 [0m[2m│   [0m[94mreturn[0m embedder, index, texts                                              [31m [0m
[31m [0m   [2m 57 [0m                                                                               [31m [0m
[31m [0m [31m❱ [0m 58 embedder, index, lore_chunks = [1;4mload_lore()[0m                                     [31m [0m
[31m [0m   [2m 59 [0m                                                                               [31m [0m
[31m [0m   [2m 60 [0m[94mdef[0m[90m [0m[92mretrieve_lore[0m(query, k=[94m1[0m):                                                 [31m [0m
[31m [0m   [2m 61 [0m[2m│   [0mquery_embedding = embedder.encode([query])[[94m0[0m]                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m47[0m in [92mload_lore[0m                                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 44 [0m[94mdef[0m[90m [0m[92mload_lore[0m():                                                               [31m [0m
[31m [0m   [2m 45 [0m[2m│   [0membedder = SentenceTransformer([33m"[0m[33mall-MiniLM-L6-v2[0m[33m"[0m)                         [31m [0m
[31m [0m   [2m 46 [0m[2m│   [0mtexts = []                                                                 [31m [0m
[31m [0m [31m❱ [0m 47 [2m│   [0m[94mfor[0m file [95min[0m [1;4mos.listdir([0m[1;4;33m"[0m[1;4;33mlore/[0m[1;4;33m"[0m[1;4m)[0m:                                           [31m [0m
[31m [0m   [2m 48 [0m[2m│   │   [0m[94mif[0m file.endswith([33m"[0m[33m.txt[0m[33m"[0m) [95mor[0m file.endswith([33m"[0m[33m.md[0m[33m"[0m):                      [31m [0m
[31m [0m   [2m 49 [0m[2m│   │   │   [0m[94mwith[0m [96mopen[0m(os.path.join([33m"[0m[33mlore[0m[33m"[0m, file), [33m'[0m[33mr[0m[33m'[0m, encoding=[33m'[0m[33mutf-8[0m[33m'[0m) [94mas[0m f: [31m [0m
[31m [0m   [2m 50 [0m[2m│   │   │   │   [0mcontent = f.read()                                             [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mFileNotFoundError: [0m[1m[[0mErrno [1;36m2[0m[1m][0m No such file or directory: [32m'lore/'[0m
2025-05-17 06:38:27.251 Examining the path of torch.classes raised:
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/local_sources_watcher.py", line 217, in get_module_paths
    potential_paths = extract_paths(module)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/local_sources_watcher.py", line 210, in <lambda>
    lambda m: list(m.__path__._path),
                   ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/_classes.py", line 13, in __getattr__
    proxy = torch._C._get_custom_class_python_wrapper(self.name, attr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Tried to instantiate class '__path__._path', but it does not exist! Ensure that it is registered via torch::class_
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:13<00:13, 13.12s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.58s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m409[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m406 [0m[2;33m│   [0m[33m</Tip>[0m                                                                     [31m [0m
[31m [0m   [2m407 [0m[2;33m│   [0m[33m"""[0m                                                                        [31m [0m
[31m [0m   [2m408 [0m[2m│   [0m[94mtry[0m:                                                                       [31m [0m
[31m [0m [31m❱ [0m409 [2m│   │   [0mresponse.raise_for_status()                                            [31m [0m
[31m [0m   [2m410 [0m[2m│   [0m[94mexcept[0m HTTPError [94mas[0m e:                                                     [31m [0m
[31m [0m   [2m411 [0m[2m│   │   [0merror_code = response.headers.get([33m"[0m[33mX-Error-Code[0m[33m"[0m)                      [31m [0m
[31m [0m   [2m412 [0m[2m│   │   [0merror_message = response.headers.get([33m"[0m[33mX-Error-Message[0m[33m"[0m)                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/requests/[0m[1;33mmodels.py[0m:[94m1024[0m in [92mraise_for_status[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1021 [0m[2m│   │   │   [0m)                                                                 [31m [0m
[31m [0m   [2m1022 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1023 [0m[2m│   │   [0m[94mif[0m http_error_msg:                                                    [31m [0m
[31m [0m [31m❱ [0m1024 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m HTTPError(http_error_msg, response=[0m[1;4;96mself[0m[1;4m)[0m                    [31m [0m
[31m [0m   [2m1025 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1026 [0m[2m│   [0m[94mdef[0m[90m [0m[92mclose[0m([96mself[0m):                                                          [31m [0m
[31m [0m   [2m1027 [0m[2;90m│   │   [0m[33m"""Releases the connection back to the pool. Once this method has bee[0m [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mHTTPError: [0m[1;36m401[0m Client Error: Unauthorized for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json[0m

[3mThe above exception was the direct cause of the following exception:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m260[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m257 [0m[2m│   │   │   [0mconfig_file = os.path.join(path, CONFIG_NAME)                      [31m [0m
[31m [0m   [2m258 [0m[2m│   │   [0m[94melse[0m:                                                                  [31m [0m
[31m [0m   [2m259 [0m[2m│   │   │   [0m[94mtry[0m:                                                               [31m [0m
[31m [0m [31m❱ [0m260 [2m│   │   │   │   [0mconfig_file = hf_hub_download(                                 [31m [0m
[31m [0m   [2m261 [0m[2m│   │   │   │   │   [0mmodel_id,                                                  [31m [0m
[31m [0m   [2m262 [0m[2m│   │   │   │   │   [0mCONFIG_NAME,                                               [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1008[0m in     [31m [0m
[31m [0m [92mhf_hub_download[0m                                                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1005 [0m[2m│   │   │   [0mlocal_files_only=local_files_only,                                [31m [0m
[31m [0m   [2m1006 [0m[2m│   │   [0m)                                                                     [31m [0m
[31m [0m   [2m1007 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m [31m❱ [0m1008 [2m│   │   [0m[94mreturn[0m _hf_hub_download_to_cache_dir(                                 [31m [0m
[31m [0m   [2m1009 [0m[2m│   │   │   [0m[2m# Destination[0m                                                     [31m [0m
[31m [0m   [2m1010 [0m[2m│   │   │   [0mcache_dir=cache_dir,                                              [31m [0m
[31m [0m   [2m1011 [0m[2m│   │   │   [0m[2m# File info[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1115[0m in     [31m [0m
[31m [0m [92m_hf_hub_download_to_cache_dir[0m                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1112 [0m[2m│   │   │   │   │   [0m[94mreturn[0m pointer_path                                       [31m [0m
[31m [0m   [2m1113 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1114 [0m[2m│   │   [0m[2m# Otherwise, raise appropriate error[0m                                  [31m [0m
[31m [0m [31m❱ [0m1115 [2m│   │   [0m[1;4m_raise_on_head_call_error(head_call_error, force_download, local_file[0m [31m [0m
[31m [0m   [2m1116 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1117 [0m[2m│   [0m[2m# From now on, etag, commit_hash, url and size are not None.[0m              [31m [0m
[31m [0m   [2m1118 [0m[2m│   [0m[94massert[0m etag [95mis[0m [95mnot[0m [94mNone[0m, [33m"[0m[33metag must have been retrieved from server[0m[33m"[0m      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1643[0m in     [31m [0m
[31m [0m [92m_raise_on_head_call_error[0m                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1640 [0m[2m│   [0m):                                                                        [31m [0m
[31m [0m   [2m1641 [0m[2m│   │   [0m[2m# Repo not found or gated => let's raise the actual error[0m             [31m [0m
[31m [0m   [2m1642 [0m[2m│   │   [0m[2m# Unauthorized => likely a token issue => let's raise the actual erro[0m [31m [0m
[31m [0m [31m❱ [0m1643 [2m│   │   [0m[1;4;94mraise[0m[1;4m head_call_error[0m                                                 [31m [0m
[31m [0m   [2m1644 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m   [2m1645 [0m[2m│   │   [0m[2m# Otherwise: most likely a connection issue or Hub downtime => let's [0m [31m [0m
[31m [0m   [2m1646 [0m[2m│   │   [0m[94mraise[0m LocalEntryNotFoundError(                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1531[0m in     [31m [0m
[31m [0m [92m_get_metadata_or_catch_error[0m                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1528 [0m[2m│   [0m[94mif[0m [95mnot[0m local_files_only:                                                  [31m [0m
[31m [0m   [2m1529 [0m[2m│   │   [0m[94mtry[0m:                                                                  [31m [0m
[31m [0m   [2m1530 [0m[2m│   │   │   [0m[94mtry[0m:                                                              [31m [0m
[31m [0m [31m❱ [0m1531 [2m│   │   │   │   [0mmetadata = get_hf_file_metadata(                              [31m [0m
[31m [0m   [2m1532 [0m[2m│   │   │   │   │   [0murl=url, proxies=proxies, timeout=etag_timeout, headers=h [31m [0m
[31m [0m   [2m1533 [0m[2m│   │   │   │   [0m)                                                             [31m [0m
[31m [0m   [2m1534 [0m[2m│   │   │   [0m[94mexcept[0m EntryNotFoundError [94mas[0m http_error:                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1448[0m in     [31m [0m
[31m [0m [92mget_hf_file_metadata[0m                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1445 [0m[2m│   [0mhf_headers[[33m"[0m[33mAccept-Encoding[0m[33m"[0m] = [33m"[0m[33midentity[0m[33m"[0m  [2m# prevent any compression => [0m [31m [0m
[31m [0m   [2m1446 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1447 [0m[2m│   [0m[2m# Retrieve metadata[0m                                                       [31m [0m
[31m [0m [31m❱ [0m1448 [2m│   [0mr = _request_wrapper(                                                     [31m [0m
[31m [0m   [2m1449 [0m[2m│   │   [0mmethod=[33m"[0m[33mHEAD[0m[33m"[0m,                                                        [31m [0m
[31m [0m   [2m1450 [0m[2m│   │   [0murl=url,                                                              [31m [0m
[31m [0m   [2m1451 [0m[2m│   │   [0mheaders=hf_headers,                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m286[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 283 [0m[2;33m│   [0m[33m"""[0m                                                                       [31m [0m
[31m [0m   [2m 284 [0m[2m│   [0m[2m# Recursively follow relative redirects[0m                                   [31m [0m
[31m [0m   [2m 285 [0m[2m│   [0m[94mif[0m follow_relative_redirects:                                             [31m [0m
[31m [0m [31m❱ [0m 286 [2m│   │   [0mresponse = _request_wrapper(                                          [31m [0m
[31m [0m   [2m 287 [0m[2m│   │   │   [0mmethod=method,                                                    [31m [0m
[31m [0m   [2m 288 [0m[2m│   │   │   [0murl=url,                                                          [31m [0m
[31m [0m   [2m 289 [0m[2m│   │   │   [0mfollow_relative_redirects=[94mFalse[0m,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m310[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 307 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 308 [0m[2m│   [0m[2m# Perform request and return if status_code is not in the retry list.[0m     [31m [0m
[31m [0m   [2m 309 [0m[2m│   [0mresponse = http_backoff(method=method, url=url, **params, retry_on_except [31m [0m
[31m [0m [31m❱ [0m 310 [2m│   [0m[1;4mhf_raise_for_status(response)[0m                                             [31m [0m
[31m [0m   [2m 311 [0m[2m│   [0m[94mreturn[0m response                                                           [31m [0m
[31m [0m   [2m 312 [0m                                                                              [31m [0m
[31m [0m   [2m 313 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m459[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m456 [0m[2m│   │   │   │   [0m[33m"[0m[33m make sure you are authenticated. For more details, see[0m[33m"[0m      [31m [0m
[31m [0m   [2m457 [0m[2m│   │   │   │   [0m[33m"[0m[33m https://huggingface.co/docs/huggingface_hub/authentication[0m[33m"[0m  [31m [0m
[31m [0m   [2m458 [0m[2m│   │   │   [0m)                                                                  [31m [0m
[31m [0m [31m❱ [0m459 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m _format(RepositoryNotFoundError, message, response) [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96me[0m   [31m [0m
[31m [0m   [2m460 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m461 [0m[2m│   │   [0m[94melif[0m response.status_code == [94m400[0m:                                      [31m [0m
[31m [0m   [2m462 [0m[2m│   │   │   [0mmessage = (                                                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mRepositoryNotFoundError: [0m[1;36m401[0m Client Error. [1m([0mRequest ID: 
[33mRoot[0m=[1;36m1[0m-68282f0b-01f36fc53f0dd1f4140a2c01;[93m4009bee0-8fae-433f-9743-d560b94aa54c[0m[1m)[0m

Repository Not Found for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json.[0m
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated. 
For more details, see [4;94mhttps://huggingface.co/docs/huggingface_hub/authentication[0m
Invalid username or password.

[3mDuring handling of the above exception, another exception occurred:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m121[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m645[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m39[0m in [92m<module>[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m   [2m 37 [0m                                                                               [31m [0m
[31m [0m   [2m 38 [0m[94mwith[0m st.spinner([33m"[0m[33mLoading model and tokenizer...[0m[33m"[0m):                             [31m [0m
[31m [0m [31m❱ [0m 39 [2m│   [0mmodel, tokenizer = [1;4mload_model(use_entity_personality)[0m                      [31m [0m
[31m [0m   [2m 40 [0m[2m│   [0mpipe = pipeline([33m"[0m[33mtext-generation[0m[33m"[0m, model=model, tokenizer=tokenizer, devic [31m [0m
[31m [0m   [2m 41 [0m                                                                               [31m [0m
[31m [0m   [2m 42 [0m[2m# --- Lore setup ---[0m                                                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m33[0m in [92mload_model[0m                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 30 [0m[2m│   [0m)                                                                          [31m [0m
[31m [0m   [2m 31 [0m[2m│   [0mtokenizer = AutoTokenizer.from_pretrained([33m"[0m[33mmicrosoft/phi-2[0m[33m"[0m)               [31m [0m
[31m [0m   [2m 32 [0m[2m│   [0m[94mif[0m use_entity:                                                             [31m [0m
[31m [0m [31m❱ [0m 33 [2m│   │   [0mmodel = [1;4mPeftModel.from_pretrained(base_model, [0m[1;4;33m"[0m[1;4;33madapters/entity_lora_ad[0m [31m [0m
[31m [0m   [2m 34 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m   [2m 35 [0m[2m│   │   [0mmodel = base_model                                                     [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mpeft_model.py[0m:[94m439[0m in [92mfrom_pretrained[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 436 [0m[2m│   │   [0m[2m# load the config[0m                                                     [31m [0m
[31m [0m   [2m 437 [0m[2m│   │   [0m[94mif[0m config [95mis[0m [94mNone[0m:                                                    [31m [0m
[31m [0m   [2m 438 [0m[2m│   │   │   [0mconfig = PEFT_TYPE_TO_CONFIG_MAPPING[                             [31m [0m
[31m [0m [31m❱ [0m 439 [2m│   │   │   │   [0mPeftConfig._get_peft_type(                                    [31m [0m
[31m [0m   [2m 440 [0m[2m│   │   │   │   │   [0mmodel_id,                                                 [31m [0m
[31m [0m   [2m 441 [0m[2m│   │   │   │   │   [0msubfolder=kwargs.get([33m"[0m[33msubfolder[0m[33m"[0m, [94mNone[0m),                  [31m [0m
[31m [0m   [2m 442 [0m[2m│   │   │   │   │   [0mrevision=kwargs.get([33m"[0m[33mrevision[0m[33m"[0m, [94mNone[0m),                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m266[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m   [2m264 [0m[2m│   │   │   │   [0m)                                                              [31m [0m
[31m [0m   [2m265 [0m[2m│   │   │   [0m[94mexcept[0m [96mException[0m:                                                  [31m [0m
[31m [0m [31m❱ [0m266 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mValueError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33mCan[0m[1;4;33m'[0m[1;4;33mt find [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mCONFIG_NAME[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m at [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mmodel_id[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m"[0m [31m [0m
[31m [0m   [2m267 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m268 [0m[2m│   │   [0mloaded_attributes = [96mcls[0m.from_json_file(config_file)                    [31m [0m
[31m [0m   [2m269 [0m[2m│   │   [0m[94mreturn[0m loaded_attributes[[33m"[0m[33mpeft_type[0m[33m"[0m]                                  [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mValueError: [0mCan't find [32m'adapter_config.json'[0m at [32m'adapters/entity_lora_adapter'[0m
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:13<00:13, 13.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.99s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.37s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m409[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m406 [0m[2;33m│   [0m[33m</Tip>[0m                                                                     [31m [0m
[31m [0m   [2m407 [0m[2;33m│   [0m[33m"""[0m                                                                        [31m [0m
[31m [0m   [2m408 [0m[2m│   [0m[94mtry[0m:                                                                       [31m [0m
[31m [0m [31m❱ [0m409 [2m│   │   [0mresponse.raise_for_status()                                            [31m [0m
[31m [0m   [2m410 [0m[2m│   [0m[94mexcept[0m HTTPError [94mas[0m e:                                                     [31m [0m
[31m [0m   [2m411 [0m[2m│   │   [0merror_code = response.headers.get([33m"[0m[33mX-Error-Code[0m[33m"[0m)                      [31m [0m
[31m [0m   [2m412 [0m[2m│   │   [0merror_message = response.headers.get([33m"[0m[33mX-Error-Message[0m[33m"[0m)                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/requests/[0m[1;33mmodels.py[0m:[94m1024[0m in [92mraise_for_status[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1021 [0m[2m│   │   │   [0m)                                                                 [31m [0m
[31m [0m   [2m1022 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1023 [0m[2m│   │   [0m[94mif[0m http_error_msg:                                                    [31m [0m
[31m [0m [31m❱ [0m1024 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m HTTPError(http_error_msg, response=[0m[1;4;96mself[0m[1;4m)[0m                    [31m [0m
[31m [0m   [2m1025 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1026 [0m[2m│   [0m[94mdef[0m[90m [0m[92mclose[0m([96mself[0m):                                                          [31m [0m
[31m [0m   [2m1027 [0m[2;90m│   │   [0m[33m"""Releases the connection back to the pool. Once this method has bee[0m [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mHTTPError: [0m[1;36m401[0m Client Error: Unauthorized for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json[0m

[3mThe above exception was the direct cause of the following exception:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m260[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m257 [0m[2m│   │   │   [0mconfig_file = os.path.join(path, CONFIG_NAME)                      [31m [0m
[31m [0m   [2m258 [0m[2m│   │   [0m[94melse[0m:                                                                  [31m [0m
[31m [0m   [2m259 [0m[2m│   │   │   [0m[94mtry[0m:                                                               [31m [0m
[31m [0m [31m❱ [0m260 [2m│   │   │   │   [0mconfig_file = hf_hub_download(                                 [31m [0m
[31m [0m   [2m261 [0m[2m│   │   │   │   │   [0mmodel_id,                                                  [31m [0m
[31m [0m   [2m262 [0m[2m│   │   │   │   │   [0mCONFIG_NAME,                                               [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1008[0m in     [31m [0m
[31m [0m [92mhf_hub_download[0m                                                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1005 [0m[2m│   │   │   [0mlocal_files_only=local_files_only,                                [31m [0m
[31m [0m   [2m1006 [0m[2m│   │   [0m)                                                                     [31m [0m
[31m [0m   [2m1007 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m [31m❱ [0m1008 [2m│   │   [0m[94mreturn[0m _hf_hub_download_to_cache_dir(                                 [31m [0m
[31m [0m   [2m1009 [0m[2m│   │   │   [0m[2m# Destination[0m                                                     [31m [0m
[31m [0m   [2m1010 [0m[2m│   │   │   [0mcache_dir=cache_dir,                                              [31m [0m
[31m [0m   [2m1011 [0m[2m│   │   │   [0m[2m# File info[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1115[0m in     [31m [0m
[31m [0m [92m_hf_hub_download_to_cache_dir[0m                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1112 [0m[2m│   │   │   │   │   [0m[94mreturn[0m pointer_path                                       [31m [0m
[31m [0m   [2m1113 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1114 [0m[2m│   │   [0m[2m# Otherwise, raise appropriate error[0m                                  [31m [0m
[31m [0m [31m❱ [0m1115 [2m│   │   [0m[1;4m_raise_on_head_call_error(head_call_error, force_download, local_file[0m [31m [0m
[31m [0m   [2m1116 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1117 [0m[2m│   [0m[2m# From now on, etag, commit_hash, url and size are not None.[0m              [31m [0m
[31m [0m   [2m1118 [0m[2m│   [0m[94massert[0m etag [95mis[0m [95mnot[0m [94mNone[0m, [33m"[0m[33metag must have been retrieved from server[0m[33m"[0m      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1643[0m in     [31m [0m
[31m [0m [92m_raise_on_head_call_error[0m                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1640 [0m[2m│   [0m):                                                                        [31m [0m
[31m [0m   [2m1641 [0m[2m│   │   [0m[2m# Repo not found or gated => let's raise the actual error[0m             [31m [0m
[31m [0m   [2m1642 [0m[2m│   │   [0m[2m# Unauthorized => likely a token issue => let's raise the actual erro[0m [31m [0m
[31m [0m [31m❱ [0m1643 [2m│   │   [0m[1;4;94mraise[0m[1;4m head_call_error[0m                                                 [31m [0m
[31m [0m   [2m1644 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m   [2m1645 [0m[2m│   │   [0m[2m# Otherwise: most likely a connection issue or Hub downtime => let's [0m [31m [0m
[31m [0m   [2m1646 [0m[2m│   │   [0m[94mraise[0m LocalEntryNotFoundError(                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1531[0m in     [31m [0m
[31m [0m [92m_get_metadata_or_catch_error[0m                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1528 [0m[2m│   [0m[94mif[0m [95mnot[0m local_files_only:                                                  [31m [0m
[31m [0m   [2m1529 [0m[2m│   │   [0m[94mtry[0m:                                                                  [31m [0m
[31m [0m   [2m1530 [0m[2m│   │   │   [0m[94mtry[0m:                                                              [31m [0m
[31m [0m [31m❱ [0m1531 [2m│   │   │   │   [0mmetadata = get_hf_file_metadata(                              [31m [0m
[31m [0m   [2m1532 [0m[2m│   │   │   │   │   [0murl=url, proxies=proxies, timeout=etag_timeout, headers=h [31m [0m
[31m [0m   [2m1533 [0m[2m│   │   │   │   [0m)                                                             [31m [0m
[31m [0m   [2m1534 [0m[2m│   │   │   [0m[94mexcept[0m EntryNotFoundError [94mas[0m http_error:                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1448[0m in     [31m [0m
[31m [0m [92mget_hf_file_metadata[0m                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1445 [0m[2m│   [0mhf_headers[[33m"[0m[33mAccept-Encoding[0m[33m"[0m] = [33m"[0m[33midentity[0m[33m"[0m  [2m# prevent any compression => [0m [31m [0m
[31m [0m   [2m1446 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1447 [0m[2m│   [0m[2m# Retrieve metadata[0m                                                       [31m [0m
[31m [0m [31m❱ [0m1448 [2m│   [0mr = _request_wrapper(                                                     [31m [0m
[31m [0m   [2m1449 [0m[2m│   │   [0mmethod=[33m"[0m[33mHEAD[0m[33m"[0m,                                                        [31m [0m
[31m [0m   [2m1450 [0m[2m│   │   [0murl=url,                                                              [31m [0m
[31m [0m   [2m1451 [0m[2m│   │   [0mheaders=hf_headers,                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m286[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 283 [0m[2;33m│   [0m[33m"""[0m                                                                       [31m [0m
[31m [0m   [2m 284 [0m[2m│   [0m[2m# Recursively follow relative redirects[0m                                   [31m [0m
[31m [0m   [2m 285 [0m[2m│   [0m[94mif[0m follow_relative_redirects:                                             [31m [0m
[31m [0m [31m❱ [0m 286 [2m│   │   [0mresponse = _request_wrapper(                                          [31m [0m
[31m [0m   [2m 287 [0m[2m│   │   │   [0mmethod=method,                                                    [31m [0m
[31m [0m   [2m 288 [0m[2m│   │   │   [0murl=url,                                                          [31m [0m
[31m [0m   [2m 289 [0m[2m│   │   │   [0mfollow_relative_redirects=[94mFalse[0m,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m310[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 307 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 308 [0m[2m│   [0m[2m# Perform request and return if status_code is not in the retry list.[0m     [31m [0m
[31m [0m   [2m 309 [0m[2m│   [0mresponse = http_backoff(method=method, url=url, **params, retry_on_except [31m [0m
[31m [0m [31m❱ [0m 310 [2m│   [0m[1;4mhf_raise_for_status(response)[0m                                             [31m [0m
[31m [0m   [2m 311 [0m[2m│   [0m[94mreturn[0m response                                                           [31m [0m
[31m [0m   [2m 312 [0m                                                                              [31m [0m
[31m [0m   [2m 313 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m459[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m456 [0m[2m│   │   │   │   [0m[33m"[0m[33m make sure you are authenticated. For more details, see[0m[33m"[0m      [31m [0m
[31m [0m   [2m457 [0m[2m│   │   │   │   [0m[33m"[0m[33m https://huggingface.co/docs/huggingface_hub/authentication[0m[33m"[0m  [31m [0m
[31m [0m   [2m458 [0m[2m│   │   │   [0m)                                                                  [31m [0m
[31m [0m [31m❱ [0m459 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m _format(RepositoryNotFoundError, message, response) [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96me[0m   [31m [0m
[31m [0m   [2m460 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m461 [0m[2m│   │   [0m[94melif[0m response.status_code == [94m400[0m:                                      [31m [0m
[31m [0m   [2m462 [0m[2m│   │   │   [0mmessage = (                                                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mRepositoryNotFoundError: [0m[1;36m401[0m Client Error. [1m([0mRequest ID: 
[33mRoot[0m=[1;36m1[0m-68282f3d-3e2cf82c56b65b213a88d27e;[93md63419fa-5092-46e5-ac31-2a7a4299cb9f[0m[1m)[0m

Repository Not Found for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json.[0m
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated. 
For more details, see [4;94mhttps://huggingface.co/docs/huggingface_hub/authentication[0m
Invalid username or password.

[3mDuring handling of the above exception, another exception occurred:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m121[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m645[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m39[0m in [92m<module>[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m   [2m 37 [0m                                                                               [31m [0m
[31m [0m   [2m 38 [0m[94mwith[0m st.spinner([33m"[0m[33mLoading model and tokenizer...[0m[33m"[0m):                             [31m [0m
[31m [0m [31m❱ [0m 39 [2m│   [0mmodel, tokenizer = [1;4mload_model(use_entity_personality)[0m                      [31m [0m
[31m [0m   [2m 40 [0m[2m│   [0mpipe = pipeline([33m"[0m[33mtext-generation[0m[33m"[0m, model=model, tokenizer=tokenizer, devic [31m [0m
[31m [0m   [2m 41 [0m                                                                               [31m [0m
[31m [0m   [2m 42 [0m[2m# --- Lore setup ---[0m                                                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m33[0m in [92mload_model[0m                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 30 [0m[2m│   [0m)                                                                          [31m [0m
[31m [0m   [2m 31 [0m[2m│   [0mtokenizer = AutoTokenizer.from_pretrained([33m"[0m[33mmicrosoft/phi-2[0m[33m"[0m)               [31m [0m
[31m [0m   [2m 32 [0m[2m│   [0m[94mif[0m use_entity:                                                             [31m [0m
[31m [0m [31m❱ [0m 33 [2m│   │   [0mmodel = [1;4mPeftModel.from_pretrained(base_model, [0m[1;4;33m"[0m[1;4;33madapters/entity_lora_ad[0m [31m [0m
[31m [0m   [2m 34 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m   [2m 35 [0m[2m│   │   [0mmodel = base_model                                                     [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mpeft_model.py[0m:[94m439[0m in [92mfrom_pretrained[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 436 [0m[2m│   │   [0m[2m# load the config[0m                                                     [31m [0m
[31m [0m   [2m 437 [0m[2m│   │   [0m[94mif[0m config [95mis[0m [94mNone[0m:                                                    [31m [0m
[31m [0m   [2m 438 [0m[2m│   │   │   [0mconfig = PEFT_TYPE_TO_CONFIG_MAPPING[                             [31m [0m
[31m [0m [31m❱ [0m 439 [2m│   │   │   │   [0mPeftConfig._get_peft_type(                                    [31m [0m
[31m [0m   [2m 440 [0m[2m│   │   │   │   │   [0mmodel_id,                                                 [31m [0m
[31m [0m   [2m 441 [0m[2m│   │   │   │   │   [0msubfolder=kwargs.get([33m"[0m[33msubfolder[0m[33m"[0m, [94mNone[0m),                  [31m [0m
[31m [0m   [2m 442 [0m[2m│   │   │   │   │   [0mrevision=kwargs.get([33m"[0m[33mrevision[0m[33m"[0m, [94mNone[0m),                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m266[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m   [2m264 [0m[2m│   │   │   │   [0m)                                                              [31m [0m
[31m [0m   [2m265 [0m[2m│   │   │   [0m[94mexcept[0m [96mException[0m:                                                  [31m [0m
[31m [0m [31m❱ [0m266 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mValueError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33mCan[0m[1;4;33m'[0m[1;4;33mt find [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mCONFIG_NAME[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m at [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mmodel_id[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m"[0m [31m [0m
[31m [0m   [2m267 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m268 [0m[2m│   │   [0mloaded_attributes = [96mcls[0m.from_json_file(config_file)                    [31m [0m
[31m [0m   [2m269 [0m[2m│   │   [0m[94mreturn[0m loaded_attributes[[33m"[0m[33mpeft_type[0m[33m"[0m]                                  [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mValueError: [0mCan't find [32m'adapter_config.json'[0m at [32m'adapters/entity_lora_adapter'[0m
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.74s/it]
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m409[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m406 [0m[2;33m│   [0m[33m</Tip>[0m                                                                     [31m [0m
[31m [0m   [2m407 [0m[2;33m│   [0m[33m"""[0m                                                                        [31m [0m
[31m [0m   [2m408 [0m[2m│   [0m[94mtry[0m:                                                                       [31m [0m
[31m [0m [31m❱ [0m409 [2m│   │   [0mresponse.raise_for_status()                                            [31m [0m
[31m [0m   [2m410 [0m[2m│   [0m[94mexcept[0m HTTPError [94mas[0m e:                                                     [31m [0m
[31m [0m   [2m411 [0m[2m│   │   [0merror_code = response.headers.get([33m"[0m[33mX-Error-Code[0m[33m"[0m)                      [31m [0m
[31m [0m   [2m412 [0m[2m│   │   [0merror_message = response.headers.get([33m"[0m[33mX-Error-Message[0m[33m"[0m)                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/requests/[0m[1;33mmodels.py[0m:[94m1024[0m in [92mraise_for_status[0m  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1021 [0m[2m│   │   │   [0m)                                                                 [31m [0m
[31m [0m   [2m1022 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1023 [0m[2m│   │   [0m[94mif[0m http_error_msg:                                                    [31m [0m
[31m [0m [31m❱ [0m1024 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m HTTPError(http_error_msg, response=[0m[1;4;96mself[0m[1;4m)[0m                    [31m [0m
[31m [0m   [2m1025 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1026 [0m[2m│   [0m[94mdef[0m[90m [0m[92mclose[0m([96mself[0m):                                                          [31m [0m
[31m [0m   [2m1027 [0m[2;90m│   │   [0m[33m"""Releases the connection back to the pool. Once this method has bee[0m [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mHTTPError: [0m[1;36m401[0m Client Error: Unauthorized for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json[0m

[3mThe above exception was the direct cause of the following exception:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m260[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m257 [0m[2m│   │   │   [0mconfig_file = os.path.join(path, CONFIG_NAME)                      [31m [0m
[31m [0m   [2m258 [0m[2m│   │   [0m[94melse[0m:                                                                  [31m [0m
[31m [0m   [2m259 [0m[2m│   │   │   [0m[94mtry[0m:                                                               [31m [0m
[31m [0m [31m❱ [0m260 [2m│   │   │   │   [0mconfig_file = hf_hub_download(                                 [31m [0m
[31m [0m   [2m261 [0m[2m│   │   │   │   │   [0mmodel_id,                                                  [31m [0m
[31m [0m   [2m262 [0m[2m│   │   │   │   │   [0mCONFIG_NAME,                                               [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1008[0m in     [31m [0m
[31m [0m [92mhf_hub_download[0m                                                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1005 [0m[2m│   │   │   [0mlocal_files_only=local_files_only,                                [31m [0m
[31m [0m   [2m1006 [0m[2m│   │   [0m)                                                                     [31m [0m
[31m [0m   [2m1007 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m [31m❱ [0m1008 [2m│   │   [0m[94mreturn[0m _hf_hub_download_to_cache_dir(                                 [31m [0m
[31m [0m   [2m1009 [0m[2m│   │   │   [0m[2m# Destination[0m                                                     [31m [0m
[31m [0m   [2m1010 [0m[2m│   │   │   [0mcache_dir=cache_dir,                                              [31m [0m
[31m [0m   [2m1011 [0m[2m│   │   │   [0m[2m# File info[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1115[0m in     [31m [0m
[31m [0m [92m_hf_hub_download_to_cache_dir[0m                                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1112 [0m[2m│   │   │   │   │   [0m[94mreturn[0m pointer_path                                       [31m [0m
[31m [0m   [2m1113 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m   [2m1114 [0m[2m│   │   [0m[2m# Otherwise, raise appropriate error[0m                                  [31m [0m
[31m [0m [31m❱ [0m1115 [2m│   │   [0m[1;4m_raise_on_head_call_error(head_call_error, force_download, local_file[0m [31m [0m
[31m [0m   [2m1116 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1117 [0m[2m│   [0m[2m# From now on, etag, commit_hash, url and size are not None.[0m              [31m [0m
[31m [0m   [2m1118 [0m[2m│   [0m[94massert[0m etag [95mis[0m [95mnot[0m [94mNone[0m, [33m"[0m[33metag must have been retrieved from server[0m[33m"[0m      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1643[0m in     [31m [0m
[31m [0m [92m_raise_on_head_call_error[0m                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1640 [0m[2m│   [0m):                                                                        [31m [0m
[31m [0m   [2m1641 [0m[2m│   │   [0m[2m# Repo not found or gated => let's raise the actual error[0m             [31m [0m
[31m [0m   [2m1642 [0m[2m│   │   [0m[2m# Unauthorized => likely a token issue => let's raise the actual erro[0m [31m [0m
[31m [0m [31m❱ [0m1643 [2m│   │   [0m[1;4;94mraise[0m[1;4m head_call_error[0m                                                 [31m [0m
[31m [0m   [2m1644 [0m[2m│   [0m[94melse[0m:                                                                     [31m [0m
[31m [0m   [2m1645 [0m[2m│   │   [0m[2m# Otherwise: most likely a connection issue or Hub downtime => let's [0m [31m [0m
[31m [0m   [2m1646 [0m[2m│   │   [0m[94mraise[0m LocalEntryNotFoundError(                                        [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1531[0m in     [31m [0m
[31m [0m [92m_get_metadata_or_catch_error[0m                                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1528 [0m[2m│   [0m[94mif[0m [95mnot[0m local_files_only:                                                  [31m [0m
[31m [0m   [2m1529 [0m[2m│   │   [0m[94mtry[0m:                                                                  [31m [0m
[31m [0m   [2m1530 [0m[2m│   │   │   [0m[94mtry[0m:                                                              [31m [0m
[31m [0m [31m❱ [0m1531 [2m│   │   │   │   [0mmetadata = get_hf_file_metadata(                              [31m [0m
[31m [0m   [2m1532 [0m[2m│   │   │   │   │   [0murl=url, proxies=proxies, timeout=etag_timeout, headers=h [31m [0m
[31m [0m   [2m1533 [0m[2m│   │   │   │   [0m)                                                             [31m [0m
[31m [0m   [2m1534 [0m[2m│   │   │   [0m[94mexcept[0m EntryNotFoundError [94mas[0m http_error:                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_validators.py[0m:[94m114[0m in  [31m [0m
[31m [0m [92m_inner_fn[0m                                                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m111 [0m[2m│   │   [0m[94mif[0m check_use_auth_token:                                               [31m [0m
[31m [0m   [2m112 [0m[2m│   │   │   [0mkwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[91m__name__[0m, ha [31m [0m
[31m [0m   [2m113 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m [31m❱ [0m114 [2m│   │   [0m[94mreturn[0m [1;4mfn(*args, **kwargs)[0m                                             [31m [0m
[31m [0m   [2m115 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m116 [0m[2m│   [0m[94mreturn[0m _inner_fn  [2m# type: ignore[0m                                           [31m [0m
[31m [0m   [2m117 [0m                                                                               [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m1448[0m in     [31m [0m
[31m [0m [92mget_hf_file_metadata[0m                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1445 [0m[2m│   [0mhf_headers[[33m"[0m[33mAccept-Encoding[0m[33m"[0m] = [33m"[0m[33midentity[0m[33m"[0m  [2m# prevent any compression => [0m [31m [0m
[31m [0m   [2m1446 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m1447 [0m[2m│   [0m[2m# Retrieve metadata[0m                                                       [31m [0m
[31m [0m [31m❱ [0m1448 [2m│   [0mr = _request_wrapper(                                                     [31m [0m
[31m [0m   [2m1449 [0m[2m│   │   [0mmethod=[33m"[0m[33mHEAD[0m[33m"[0m,                                                        [31m [0m
[31m [0m   [2m1450 [0m[2m│   │   [0murl=url,                                                              [31m [0m
[31m [0m   [2m1451 [0m[2m│   │   [0mheaders=hf_headers,                                                   [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m286[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 283 [0m[2;33m│   [0m[33m"""[0m                                                                       [31m [0m
[31m [0m   [2m 284 [0m[2m│   [0m[2m# Recursively follow relative redirects[0m                                   [31m [0m
[31m [0m   [2m 285 [0m[2m│   [0m[94mif[0m follow_relative_redirects:                                             [31m [0m
[31m [0m [31m❱ [0m 286 [2m│   │   [0mresponse = _request_wrapper(                                          [31m [0m
[31m [0m   [2m 287 [0m[2m│   │   │   [0mmethod=method,                                                    [31m [0m
[31m [0m   [2m 288 [0m[2m│   │   │   [0murl=url,                                                          [31m [0m
[31m [0m   [2m 289 [0m[2m│   │   │   [0mfollow_relative_redirects=[94mFalse[0m,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/[0m[1;33mfile_download.py[0m:[94m310[0m in      [31m [0m
[31m [0m [92m_request_wrapper[0m                                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 307 [0m[2m│   [0m                                                                          [31m [0m
[31m [0m   [2m 308 [0m[2m│   [0m[2m# Perform request and return if status_code is not in the retry list.[0m     [31m [0m
[31m [0m   [2m 309 [0m[2m│   [0mresponse = http_backoff(method=method, url=url, **params, retry_on_except [31m [0m
[31m [0m [31m❱ [0m 310 [2m│   [0m[1;4mhf_raise_for_status(response)[0m                                             [31m [0m
[31m [0m   [2m 311 [0m[2m│   [0m[94mreturn[0m response                                                           [31m [0m
[31m [0m   [2m 312 [0m                                                                              [31m [0m
[31m [0m   [2m 313 [0m                                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/[0m[1;33m_http.py[0m:[94m459[0m in        [31m [0m
[31m [0m [92mhf_raise_for_status[0m                                                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m456 [0m[2m│   │   │   │   [0m[33m"[0m[33m make sure you are authenticated. For more details, see[0m[33m"[0m      [31m [0m
[31m [0m   [2m457 [0m[2m│   │   │   │   [0m[33m"[0m[33m https://huggingface.co/docs/huggingface_hub/authentication[0m[33m"[0m  [31m [0m
[31m [0m   [2m458 [0m[2m│   │   │   [0m)                                                                  [31m [0m
[31m [0m [31m❱ [0m459 [2m│   │   │   [0m[1;4;94mraise[0m[1;4m _format(RepositoryNotFoundError, message, response) [0m[1;4;94mfrom[0m[1;4;90m [0m[1;4;96me[0m   [31m [0m
[31m [0m   [2m460 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m461 [0m[2m│   │   [0m[94melif[0m response.status_code == [94m400[0m:                                      [31m [0m
[31m [0m   [2m462 [0m[2m│   │   │   [0mmessage = (                                                        [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mRepositoryNotFoundError: [0m[1;36m401[0m Client Error. [1m([0mRequest ID: 
[33mRoot[0m=[1;36m1[0m-[1;36m68283286[0m-15494c437d572d8d523f1302;[93ma3571cce-a83b-4f56-924f-ec3c492ebaba[0m[1m)[0m

Repository Not Found for url: 
[4;94mhttps://huggingface.co/adapters/entity_lora_adapter/resolve/main/adapter_config.json.[0m
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated. 
For more details, see [4;94mhttps://huggingface.co/docs/huggingface_hub/authentication[0m
Invalid username or password.

[3mDuring handling of the above exception, another exception occurred:[0m

[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m121[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m645[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m39[0m in [92m<module>[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m   [2m 37 [0m                                                                               [31m [0m
[31m [0m   [2m 38 [0m[94mwith[0m st.spinner([33m"[0m[33mLoading model and tokenizer...[0m[33m"[0m):                             [31m [0m
[31m [0m [31m❱ [0m 39 [2m│   [0mmodel, tokenizer = [1;4mload_model(use_entity_personality)[0m                      [31m [0m
[31m [0m   [2m 40 [0m[2m│   [0mpipe = pipeline([33m"[0m[33mtext-generation[0m[33m"[0m, model=model, tokenizer=tokenizer, devic [31m [0m
[31m [0m   [2m 41 [0m                                                                               [31m [0m
[31m [0m   [2m 42 [0m[2m# --- Lore setup ---[0m                                                           [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m219[0m [31m [0m
[31m [0m in [92m__call__[0m                                                                          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m261[0m [31m [0m
[31m [0m in [92m_get_or_create_cached_value[0m                                                       [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/caching/[0m[1;33mcache_utils.py[0m:[94m320[0m [31m [0m
[31m [0m in [92m_handle_cache_miss[0m                                                                [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mapp.py[0m:[94m33[0m in [92mload_model[0m                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 30 [0m[2m│   [0m)                                                                          [31m [0m
[31m [0m   [2m 31 [0m[2m│   [0mtokenizer = AutoTokenizer.from_pretrained([33m"[0m[33mmicrosoft/phi-2[0m[33m"[0m)               [31m [0m
[31m [0m   [2m 32 [0m[2m│   [0m[94mif[0m use_entity:                                                             [31m [0m
[31m [0m [31m❱ [0m 33 [2m│   │   [0mmodel = [1;4mPeftModel.from_pretrained(base_model, [0m[1;4;33m"[0m[1;4;33madapters/entity_lora_ad[0m [31m [0m
[31m [0m   [2m 34 [0m[2m│   [0m[94melse[0m:                                                                      [31m [0m
[31m [0m   [2m 35 [0m[2m│   │   [0mmodel = base_model                                                     [31m [0m
[31m [0m   [2m 36 [0m[2m│   [0m[94mreturn[0m model, tokenizer                                                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mpeft_model.py[0m:[94m439[0m in [92mfrom_pretrained[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 436 [0m[2m│   │   [0m[2m# load the config[0m                                                     [31m [0m
[31m [0m   [2m 437 [0m[2m│   │   [0m[94mif[0m config [95mis[0m [94mNone[0m:                                                    [31m [0m
[31m [0m   [2m 438 [0m[2m│   │   │   [0mconfig = PEFT_TYPE_TO_CONFIG_MAPPING[                             [31m [0m
[31m [0m [31m❱ [0m 439 [2m│   │   │   │   [0mPeftConfig._get_peft_type(                                    [31m [0m
[31m [0m   [2m 440 [0m[2m│   │   │   │   │   [0mmodel_id,                                                 [31m [0m
[31m [0m   [2m 441 [0m[2m│   │   │   │   │   [0msubfolder=kwargs.get([33m"[0m[33msubfolder[0m[33m"[0m, [94mNone[0m),                  [31m [0m
[31m [0m   [2m 442 [0m[2m│   │   │   │   │   [0mrevision=kwargs.get([33m"[0m[33mrevision[0m[33m"[0m, [94mNone[0m),                    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/peft/[0m[1;33mconfig.py[0m:[94m266[0m in [92m_get_peft_type[0m         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m263 [0m[2m│   │   │   │   │   [0m**hf_hub_download_kwargs,                                  [31m [0m
[31m [0m   [2m264 [0m[2m│   │   │   │   [0m)                                                              [31m [0m
[31m [0m   [2m265 [0m[2m│   │   │   [0m[94mexcept[0m [96mException[0m:                                                  [31m [0m
[31m [0m [31m❱ [0m266 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mValueError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m"[0m[1;4;33mCan[0m[1;4;33m'[0m[1;4;33mt find [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mCONFIG_NAME[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m at [0m[1;4;33m'[0m[1;4;33m{[0m[1;4mmodel_id[0m[1;4;33m}[0m[1;4;33m'[0m[1;4;33m"[0m [31m [0m
[31m [0m   [2m267 [0m[2m│   │   [0m                                                                       [31m [0m
[31m [0m   [2m268 [0m[2m│   │   [0mloaded_attributes = [96mcls[0m.from_json_file(config_file)                    [31m [0m
[31m [0m   [2m269 [0m[2m│   │   [0m[94mreturn[0m loaded_attributes[[33m"[0m[33mpeft_type[0m[33m"[0m]                                  [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mValueError: [0mCan't find [32m'adapter_config.json'[0m at [32m'adapters/entity_lora_adapter'[0m
2025-05-17 06:53:59.643 Examining the path of torch.classes raised:
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/local_sources_watcher.py", line 217, in get_module_paths
    potential_paths = extract_paths(module)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/streamlit/watcher/local_sources_watcher.py", line 210, in <lambda>
    lambda m: list(m.__path__._path),
                   ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/_classes.py", line 13, in __getattr__
    proxy = torch._C._get_custom_class_python_wrapper(self.name, attr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Tried to instantiate class '__path__._path', but it does not exist! Ensure that it is registered via torch::class_
